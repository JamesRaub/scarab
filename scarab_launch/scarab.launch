<launch>
  <!-- Bring UTM30, battery monitor, diagnostics, and motors online

       Use robot_monitor to see diagnostics
  -->
  <arg name="diag_rate" default="0.4" />

  <node name="tf_throttle_$(env ROS_NAMESPACE)" pkg="topic_tools" type="throttle"
        args="bytes /$(env ROS_NAMESPACE)/tf 1024 0.5 /tf" />

  <group ns="$(env ROS_NAMESPACE)" >
    <param name="tf_prefix" value="/$(env ROS_NAMESPACE)" />
    <remap from="/tf" to="tf" />
    <node pkg="tf" type="static_transform_publisher" name="transformer"
          args="0 0 0.0 0 0 0 base laser 500" />

    <node name="laser" pkg="hokuyo_node" type="hokuyo_node" output="screen">
      <param name="cluster" value="1" />
      <param name="skip" value="1" />
      <param name="intensity" value="false" />
      <param name="min_ang" value="-2.2689" />
      <param name="max_ang" value="2.2689" />
      <param name="port" value="/dev/hokuyo" />
      <param name="frame_id" value="/$(env ROS_NAMESPACE)/laser" />
      <remap from="/diagnostics" to="laser_diagnostics" />
    </node>
    <node name="laser_diagnostics" pkg="topic_tools" type="throttle"
          args="messages /$(env ROS_NAMESPACE)/laser_diagnostics $(arg diag_rate) /diagnostics" output="screen"/>
    <node name="laser_throttle" pkg="topic_tools" type="throttle"
          args="messages /$(env ROS_NAMESPACE)/scan 1.0" />

    <node name="ibps" pkg="bb04" type="bb04_node">
      <remap from="/diagnostics" to="battery_diagnostics" />
    </node>
    <node name="battery_diagnostics" pkg="topic_tools" type="throttle"
          args="messages /$(env ROS_NAMESPACE)/battery_diagnostics $(arg diag_rate) /diagnostics "/>

    <node pkg="roboclaw" type="roboclaw_node" name="motor" respawn="false"
          output="screen">
    </node>
    <node name="odom_throttle" pkg="topic_tools" type="throttle"
          args="messages /$(env ROS_NAMESPACE)/motor/odom 2.0" />

  </group>
</launch>
