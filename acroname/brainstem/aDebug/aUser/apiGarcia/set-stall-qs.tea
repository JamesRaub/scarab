#include <aAPI.tea>
#include <aAPIGarcia.tea>

void main(int x)
{
  int n = 1;

  // queue is stored in two bytes
  // queue size can't be zero or more than 16 bits
  if (x == 0) x =1;
  if (x > 16) x = 16;
  
  // convert queue size to two-byte mask
  x = x - 1;
  while (x) {
    n = n * 2;
    x = x - 1;
  }

  aAPI_SetTxByte0(cmdCTR_SET);
  aAPI_SetTxByte1(aGARCIA_MOTO_CTR_STALLMASK);
  aAPI_SetTxShortVar(2, n);
  aAPI_SetTxLength(4);
  aAPI_BeginTx(aGARCIA_MOTO_ADDR);
}
